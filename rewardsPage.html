<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NHG Youth ‚Äì Rewards</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --border: rgba(255,255,255,.10);
      --primary: #2D63FF;
      --primary2:#4B7BFF;
      --accent: #76E4FF;

      --container: 1120px;

      --ink: #0f172a;
      --muted: #64748b;

      --cardBorder: #e6eaf2;
      --cardShadow: 0 10px 26px rgba(15,23,42,.08);

      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius-xl: 22px;
      --radius-lg: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #ffffff;
      color: var(--ink);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font-family:inherit; }

    .container{
      width: min(var(--container), calc(100% - 40px));
      margin: 0 auto;
    }

    /* ===== Header ===== */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(10px);
      background: rgba(11, 18, 32, .70);
      border-bottom: 1px solid var(--border);
      color:#fff;
    }
    .topbar-inner{
      height: 64px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:800;
      letter-spacing:.2px;
    }

    .logo{
      width:44px;height:44px;border-radius:10px;
      overflow:hidden;
      display:grid;
      place-items:center;
      background: radial-gradient(circle at 30% 30%, var(--accent), var(--primary));
      box-shadow: 0 10px 26px rgba(45,99,255,.35);
      flex: 0 0 auto;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .footerlogo{
      width:34px;height:34px;border-radius:10px;
      background: radial-gradient(circle at 30% 30%, var(--accent), var(--primary));
      box-shadow: 0 10px 26px rgba(45,99,255,.35);
    }

    .nav{
      display:flex;
      gap:18px;
      align-items:center;
      color: rgba(255,255,255,.72);
      font-weight:600;
      font-size: 14px;
    }
    .nav a{ padding:10px 10px; border-radius: 10px; }
    .nav a:hover{ background: rgba(255,255,255,.06); color:#fff; }
    .nav a.active{
      color:#fff;
      background: rgba(255,255,255,.08);
    }

    .actions{ display:flex; align-items:center; gap:10px; }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:#fff;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight:700;
      font-size: 14px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.18); }
    .btn-primary{
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      border-color: rgba(255,255,255,.0);
      box-shadow: 0 14px 36px rgba(45,99,255,.35);
    }
    .btn-primary:hover{ background: linear-gradient(90deg, #2A5BFF, #4F82FF); }

    .hamburger{
      display:none;
      width:42px;height:42px;border-radius:12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:#fff;
      cursor:pointer;
    }

    .mobile-nav{
      display:none;
      padding: 12px 0 14px;
      border-top: 1px solid var(--border);
    }
    .mobile-nav a{
      display:block;
      padding: 10px 4px;
      color: rgba(255,255,255,.72);
      font-weight:700;
    }
    .mobile-nav a:hover{ color:#fff; }
    .mobile-nav.show{ display:block; }

    /* ===== Sub navbar tabs (same-page) ===== */
    .subTabsWrap{
      background:#fff;
      border-bottom: 1px solid #e6eaf2;
    }
    .subTabs{
      height: 44px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      gap: 26px;
    }
    .subTab{
      position: relative;
      padding: 10px 2px 12px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: .1px;
      color: #64748b;
      background: transparent;
      border: 0;
      cursor: pointer;
    }
    .subTab:hover{ color:#334155; }
    .subTab.active{ color:#2563eb; }
    .subTab.active::after{
      content:"";
      position:absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 2px;
      background: #2563eb;
      border-radius: 999px;
    }

    .tabPanel{ display:none; }
    .tabPanel.show{ display:block; }

    /* ===== Points hero ===== */
    .pointsHero{
      background: linear-gradient(180deg, #2A5BFF 0%, #1F4DCC 100%);
      color:#fff;
    }
    .pointsHero-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 18px;
      padding: 20px 0;
      min-height: 150px;
    }
    .pointsLeft small{
      display:block;
      font-weight:800;
      color: rgba(255,255,255,.78);
      margin-bottom: 6px;
    }
    .pointsValue{
      font-size: 44px;
      line-height: 1.05;
      font-weight: 900;
      letter-spacing: -.6px;
      margin: 0 0 10px;
    }
    .heroBtn{
      margin-top: 12px;
      border:0;
      cursor:pointer;
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 900;
      font-size: 11px;
      color:#1d4ed8;
      background:#fff;
      box-shadow: 0 12px 26px rgba(0,0,0,.18);
    }
    .heroBtn:hover{ transform: translateY(-1px); }

    .sectionTitle{
      text-align:center;
      padding: 22px 0 10px;
    }
    .sectionTitle h2{
      margin:0;
      font-size: 14px;
      font-weight: 900;
      letter-spacing: -.2px;
      color: #0f172a;
    }

    .card{
      border:1px solid var(--cardBorder);
      border-radius: 16px;
      background:#fff;
      box-shadow: var(--cardShadow);
      padding: 14px;
    }

    /* Points History UI */
    .historyWrap{
      padding: 8px 0 12px;
      display:flex;
      justify-content:center;
    }
    .historyCard{ width: min(760px, 100%); }
    .historyItem{
      display:flex;
      justify-content:space-between;
      gap: 12px;
      padding: 12px 4px;
      border-bottom: 1px solid #eef2f7;
    }
    .historyItem:last-child{ border-bottom:0; }
    .historyLeft h4{
      margin:0 0 4px;
      font-size: 12px;
      font-weight: 900;
      color:#0f172a;
    }
    .historyLeft p{
      margin:0;
      font-size: 10px;
      font-weight: 700;
      color:#64748b;
      line-height: 1.35;
    }
    .historyPts{
      font-size: 12px;
      font-weight: 900;
      color:#0f172a;
      white-space:nowrap;
      align-self:flex-start;
    }
    .viewMore{
      display:block;
      text-align:center;
      padding-top: 10px;
      font-size: 10px;
      font-weight: 800;
      color:#64748b;
    }
    .viewMore:hover{ color:#334155; }

    /* Guest message card */
    .guestWrap{
      padding: 18px 0 0;
      display:flex;
      justify-content:center;
    }
    .guestCard{
      width: min(760px, 100%);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
    }
    .guestCard h3{
      margin:0 0 4px;
      font-size: 13px;
      font-weight: 900;
      color:#0f172a;
    }
    .guestCard p{
      margin:0;
      font-size: 11px;
      font-weight: 700;
      color:#64748b;
      line-height: 1.5;
    }

    /* Leaderboard UI */
    .leaderMeta{
      text-align:center;
      margin-top: 4px;
      font-size: 10px;
      font-weight: 700;
      color:#94a3b8;
    }
    .leaderGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      padding: 12px 0 12px;
      justify-content:center;
    }
    .leaderCard h3{
      margin:0 0 8px;
      font-size: 12px;
      font-weight: 900;
      color:#0f172a;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .leaderList{
      margin:0;
      padding:0;
      list-style:none;
      display:flex;
      flex-direction:column;
      gap: 8px;
      font-size: 11px;
      font-weight: 800;
      color:#0f172a;
    }
    .leaderRow{
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .rankNo{
      width: 18px;
      text-align:right;
      color:#64748b;
      font-weight: 900;
      font-size: 11px;
    }
    .badge{
      width: 22px;
      display:inline-flex;
      justify-content:center;
    }

    /* ===== Your Rank bar ===== */
    .rankWrap{
      padding: 10px 0 4px;
      display:flex;
      justify-content:center;
    }
    .rankBar{
      width: min(980px, 100%);
      border:1px solid #e6eaf2;
      border-radius: 16px;
      background:#fff;
      box-shadow: 0 10px 26px rgba(15,23,42,.08);
      padding: 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
    }
    .rankLeft{
      display:flex;
      align-items:center;
      gap: 12px;
    }
    .rankIcon{
      width: 42px;
      height: 42px;
      display:grid;
      place-items:center;
      border-radius: 12px;
      background: #fff7ed;
      border: 1px solid #fed7aa;
      font-size: 18px;
    }
    .rankTitle{
      font-size: 20px;
      font-weight: 900;
      color:#0f172a;
    }
    .rankHint{
      font-size: 10px;
      font-weight: 700;
      color:#94a3b8;
      margin-top: 2px;
    }

    .rankStats{
      display:flex;
      gap: 12px;
      align-items:stretch;
    }
    .rankStat{
      min-width: 140px;
      text-align:center;
      background: #eef5ff;
      border: 1px solid #dbeafe;
      border-radius: 14px;
      padding: 10px 12px;
    }
    .rankNum{
      font-size: 28px;
      line-height: 1.05;
      font-weight: 900;
      color:#0f172a;
    }
    .rankSub{
      margin-top: 2px;
      font-size: 11px;
      font-weight: 800;
      color:#334155;
      opacity: .85;
    }

    @media (max-width: 980px){
      .rankBar{ flex-direction:column; align-items:stretch; }
      .rankStats{ justify-content:space-between; }
      .rankStat{ flex:1; min-width: 0; }
    }


    /* ===== Redeem section ===== */
    .pageMain{
       padding-bottom: 22px;
       flex: 1 0 auto;
     }

    .catalogueHead{ padding: 22px 0 10px; text-align:center; }
    .catalogueHead h2{ margin:0; font-size: 14px; font-weight: 900; letter-spacing: -.2px; color: #0f172a; }

    .catalogueGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 18px;
      padding: 12px 0 22px;
      align-items:stretch;
    }

    .rewardCard{
      border:1px solid var(--cardBorder);
      border-radius: 18px;
      background:#fff;
      box-shadow: var(--cardShadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      padding: 14px;
      min-height: 360px;
    }

    .rewardMedia{
      border-radius: 14px;
      overflow:hidden;
      background:#eef2ff;
      height: 190px;
      display:grid;
      place-items:center;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    /* Make background white only for logo-style rewards */
    .rewardMedia:has(img.img-contain){
      background: #ffffff;
    }
    /* White background only for this special reward */
    .rewardMedia.rewardMedia-white{
      background: #ffffff;
    }


    .rewardMedia img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    /* Special fix for logos / non-photo rewards */
    .rewardMedia img.img-contain{
      width: auto !important;
      height: auto !important;
      max-width: 88%;
      max-height: 88%;
      object-fit: contain;
      display:block;
      margin:auto;
    }


    .rewardInfo{
      text-align:center;
      padding: 14px 10px 0;
      display:flex;
      flex-direction:column;
      gap: 8px;
      flex: 1 1 auto;
    }
    .rewardTitle{
      margin: 2px 0 0;
      font-size: 14px;
      font-weight: 900;
      color:#0f172a;
      letter-spacing: -.2px;
      line-height: 1.25;
    }
    .rewardSubtitle{
      margin: 0;
      font-size: 11px;
      font-weight: 700;
      color: #94a3b8;
    }
    .rewardPoints{
      margin: 2px 0 0;
      font-size: 16px;
      font-weight: 900;
      color:#0f172a;
    }

    .redeemBtn{
      margin-top: 14px;
      width: 100%;
      border: 0;
      cursor:pointer;
      border-radius: 999px;
      padding: 12px 14px;
      font-weight: 900;
      font-size: 12px;
      color:#fff;
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      box-shadow: 0 14px 28px rgba(45,99,255,.22);
      transition: transform .12s ease, filter .12s ease, opacity .12s ease;
    }
    .redeemBtn:hover{ transform: translateY(-1px); filter: brightness(1.02); }
    .redeemBtn:disabled{
      opacity:.65;
      cursor:not-allowed;
      box-shadow: none;
      transform:none;
    }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(15,23,42,.92);
      color:#fff;
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 800;
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{ opacity: 1; transform: translateX(-50%) translateY(-4px); }

    /* ===== Footer (Project Thrive) ===== */
    footer{
      margin-top: auto;
      background: #0b1220;
      color: rgba(255,255,255,.82);
    }
    .footer__inner{
      padding: 28px 0 26px;
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr .9fr;
      gap: 26px;
      align-items:start;
    }
    .footer__brandRow{ display:flex; align-items:center; gap:10px; margin-bottom: 10px; }
    .footer__brandName{ font-weight: 900; font-size: 14px; letter-spacing: .2px; }
    .footer__desc{
      margin:0;
      max-width: 34ch;
      color: rgba(255,255,255,.58);
      font-size: 12px;
      line-height: 1.7;
      font-weight: 600;
    }
    .footerCol h5{
      margin: 0 0 10px;
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,.86);
    }
    .footerCol a:not(.socialBtn){
      display:block;
      padding: 6px 0;
      color: rgba(255,255,255,.58);
      font-size: 12px;
      font-weight: 600;
    }
    .footerCol a:not(.socialBtn):hover{ color:#fff; }

    .footer__social{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:flex-start;
      margin-top: 2px;
    }
    .footerCol a.socialBtn{
      width: 38px;
      height: 38px;
      display:grid;
      place-items:center;
      padding: 0;
      margin: 0;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.78);
    }
    .footerCol a.socialBtn:hover{ background: rgba(255,255,255,.08); color:#fff; }
    .footerCol a.socialBtn svg{ display:block; width:19px; height:19px; }

    .footerBottom{
      border-top: 1px solid rgba(255,255,255,.08);
      padding: 12px 0 14px;
      color: rgba(255,255,255,.45);
      font-size: 11px;
      font-weight: 600;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    @media (max-width: 980px){
      .nav{ display:none; }
      .hamburger{ display:inline-flex; align-items:center; justify-content:center; }
      .catalogueGrid{ grid-template-columns: 1fr; }
      .leaderGrid{ grid-template-columns: 1fr; }
      .rewardCard{ min-height: 0; }
      .rewardMedia{ height: 210px; }

      .footer__inner{ grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 520px){
      .footer__inner{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <!-- ===== Header ===== -->
  <header class="topbar">
    <div class="container">
      <div class="topbar-inner">
        <a class="brand" href="index.html">
          <div class="logo" aria-hidden="true">
            <img src="ProjectThriveLogo.jpg" alt="Project Thrive Logo" />
          </div>
          <span>Project Thrive</span>
        </a>

        <nav class="nav" aria-label="Primary">
          <a href="events.html">Events</a>
          <a href="hybrid-learning.html">Hybrid Learning</a>
          <a href="rewardsPage.html" class="active">Rewards</a>
          <a href="ambassadors.html">Ambassadors</a>
        </nav>

        <div class="actions">
          <a class="btn btn-primary" id="navSignIn" href="login.html">Sign in</a>
          <button class="btn" type="button" id="navLogout" title="Logout (demo)">Logout</button>

          <button class="hamburger" type="button" id="hamburger" aria-label="Open menu">‚ò∞</button>
        </div>
      </div>

      <div class="mobile-nav" id="mobileNav" aria-label="Mobile">
        <a href="events.html" onclick="closeMobileNav()">Events</a>
        <a href="hybrid-learning.html" onclick="closeMobileNav()">Hybrid Learning</a>
        <a href="rewardsPage.html" onclick="closeMobileNav()">Rewards</a>
        <a href="ambassadors.html" onclick="closeMobileNav()">Ambassadors</a>
      </div>
    </div>
  </header>

  <div class="pageMain">
    <!-- ===== Sub Navbar (same-page tabs) ===== -->
    <div class="subTabsWrap" id="subTabsWrap">
      <div class="container">
        <nav class="subTabs" aria-label="Rewards sub navigation">
          <button class="subTab active" type="button" data-tab="overview">Points Overview</button>
          <button class="subTab" type="button" data-tab="redeem">Redeem Your Points</button>
        </nav>
      </div>
    </div>

    <!-- ================= TAB: OVERVIEW ================= -->
    <section id="tab-overview" class="tabPanel show">      
      <div id="loggedInOnly">
        <section class="pointsHero" aria-label="Current points banner">
          <div class="container">
            <div class="pointsHero-inner">
              <div class="pointsLeft">
                <small>Current Points:</small>
                <div class="pointsValue" id="pointsValue">‚Äî</div>
                <button class="heroBtn" type="button" onclick="openRedeemTab()">Redeem Your Points Now</button>
              </div>
            </div>
          </div>
        </section>

        <div class="container">
          <div class="sectionTitle"><h2>Points History</h2></div>
          <div class="historyWrap">
            <div class="card historyCard">
              <div class="historyItem">
                <div class="historyLeft">
                  <h4>Pop-up Events</h4>
                  <p>Workshop: Make it Siew Dai<br>2026 - 01 - 12 &nbsp;&nbsp; 12:00</p>
                </div>
                <div class="historyPts">+30 pts</div>
              </div>

              <div class="historyItem">
                <div class="historyLeft">
                  <h4>Online Course</h4>
                  <p>Workshop: Proper handling of wheelchairs<br>2026 - 01 - 02 &nbsp;&nbsp; 12:00</p>
                </div>
                <div class="historyPts">+10 pts</div>
              </div>

              <div class="historyItem">
                <div class="historyLeft">
                  <h4>Pop-up Event</h4>
                  <p>Challenge: Walking Foodpedia<br>2025 - 12 - 20 &nbsp;&nbsp; 12:00</p>
                </div>
                <div class="historyPts">+10 pts</div>
              </div>

              <a class="viewMore" href="#" onclick="event.preventDefault();">view more</a>
            </div>
          </div>
        </div>
      </div>
     
      <div id="loggedOutOnly" style="display:none;">
        <div class="container">
          <div class="guestWrap">
            <div class="card guestCard">
              <div>
                <h3>Sign in to view points</h3>
                <p>You can still view the leaderboard without signing in.</p>
              </div>
              <a class="btn btn-primary" href="login.html">Sign in</a>
            </div>
          </div>
        </div>
      </div>
      
      <div class="container">
        <div class="sectionTitle"><h2>Leaderboard</h2></div>
        <div class="leaderMeta">Updated as of: 2026 - 01 - 15 &nbsp; 12:37</div>

        <div class="leaderGrid">
          <div class="card leaderCard">
            <h3>üá∏üá¨ &nbsp;Singapore</h3>
            
            <ul class="leaderList" id="sgLeaderboard"></ul>

          </div>
        
          <div class="card leaderCard" id="friendsCard">
            <h3>üèÅ &nbsp;Friends</h3>
            <ul class="leaderList" id="friendsLeaderboard"></ul>
          </div>
        </div>
        
        <div class="rankWrap" id="rankWrap" style="display:none;">
          <div class="rankBar">
            <div class="rankLeft">
              <span class="rankIcon" aria-hidden="true">üèÜ</span>
              <div>
                <div class="rankTitle">Your Rank</div>                 
              </div>
            </div>

            <div class="rankStats">
              <div class="rankStat">
                <div class="rankNum" id="rankSG">‚Äî</div>
                <div class="rankSub">in singapore</div>
              </div>

              <div class="rankStat">
                <div class="rankNum" id="rankFR">‚Äî</div>
                <div class="rankSub">among friends</div>
              </div>
            </div>
          </div>
        </div>

      </div>

    </section>

    <!-- ================= TAB: REDEEM ================= -->
    <section id="tab-redeem" class="tabPanel">
      <main id="catalogue">
        <div class="container">
          <div class="catalogueHead"><h2>Catalogue</h2></div>

          <div class="catalogueGrid">
            <!-- Card 1 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://motoristprod.s3.amazonaws.com/uploads/reward/image/19/Fairprice_Voucher-new.png" alt="$10 Fairprice Cash Voucher">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">$10 Fairprice Cash Voucher</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">2888 points</div>
                <button class="redeemBtn" data-id="reward_001" data-name="$10 Fairprice Cash Voucher" data-cost="2888">Redeem</button>
              </div>
            </article>

            <!-- Card 2 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img class="img-contain" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRvXTgTtZIJhScg8xGtlzO75vLNkYRo8oCc6A&s" alt="$20 Fairprice Cash Voucher">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">$20 Fairprice Cash Voucher</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">3888 points</div>
                <button class="redeemBtn" data-id="reward_002" data-name="$20 Fairprice Cash Voucher" data-cost="3888">Redeem</button>
              </div>
            </article>

            <!-- Card 3 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://pw-sg-public-images.s3.ap-southeast-1.amazonaws.com/157/cms/Luckin%20Coffee%20169.png" alt="$2 Luckin Coffee Credit">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">$2 Luckin Coffee Credit</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">1488 points</div>
                <button class="redeemBtn" data-id="reward_003" data-name="$2 Luckin Coffee Credit" data-cost="1488">Redeem</button>
              </div>
            </article>

            <!-- Card 4 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://deo.shopeemobile.com/shopee/shopee-pcmall-live-sg/assets/ca5d12864c12916c05640b36e47ac5c9.png" alt="Shopee Free Shipping Voucher">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">Shopee Free Shipping Voucher</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">8888 points</div>
                <button class="redeemBtn" data-id="reward_004" data-name="Shopee Free Shipping Voucher" data-cost="8888">Redeem</button>
              </div>
            </article>

            <!-- Card 5 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://media-img-proxy-production-aps1.shopback.com/6_Jev1bJE10/aHR0cHM6Ly9pbWFnZXMuYmFubmVyYmVhci5jb20vZGlyZWN0L0VHQnFwQVo1T2U5MTg5VkROSi9yZXF1ZXN0cy8wMDAvMDQ5LzA3OC8wMTUvTnhtbzM5UmFWUTkxMlB4WlFBT2UyRXdnNS85OWNmYmY4YjAzZGJmZjU3NDFkNzBiNzI1ODQ4ZTg1NGJiYTc4OWIzLnBuZw.jpg" alt="RedMart Free Shipping Voucher">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">RedMart Free Shipping Voucher</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">888 points</div>
                <button class="redeemBtn" data-id="reward_005" data-name="RedMart Free Shipping Voucher" data-cost="888">Redeem</button>
              </div>
            </article>

            <!-- Card 6 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://pw-sg-public-images.s3.ap-southeast-1.amazonaws.com/157/cms/Luckin%20Coffee%20169.png" alt="$2.99 Luckin Coffee Exchange Coupon">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">$2.99 Luckin Coffee Exchange Coupon</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">2188 points</div>
                <button class="redeemBtn" data-id="reward_006" data-name="$2.99 Luckin Coffee Exchange Coupon" data-cost="2188">Redeem</button>
              </div>
            </article>

            <!-- Card 7 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTcExgkvWNZEF-FerqneatEHpAJRlkJBi6U4w&s" alt="Free Site Tour for 1 @ Ento Industries">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">Free Site Tour for 1 @ Ento Industries</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">2888 points</div>
                <button class="redeemBtn" data-id="reward_007" data-name="Free Site Tour for 1 @ Ento Industries" data-cost="2888">Redeem</button>
              </div>
            </article>

            <!-- Card 8 -->
            <article class="rewardCard">
              <div class="rewardMedia">
                <img src="https://changicitypoint.com.sg/wp-content/uploads/2023/11/696Mr-Bean-revised.jpg" alt="Free Mr Bean Coupon Booklet (Worth $30)">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">Free Mr Bean Coupon Booklet (Worth $30)</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">2888 points</div>
                <button class="redeemBtn" data-id="reward_008" data-name="Free Mr Bean Coupon Booklet (Worth $30)" data-cost="2888">Redeem</button>
              </div>
            </article>

            <!-- Card 9 -->
            <article class="rewardCard">
              <div class="rewardMedia rewardMedia-white">
                <img class="img-contain" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRV6xjL8car_neqA4ecj5_5R075YJhZUmjEXw&s" alt="Free Health Screening Package">
              </div>
              <div class="rewardInfo">
                <h3 class="rewardTitle">Free Health Screening Package</h3>
                <p class="rewardSubtitle">terms and conditions apply</p>
                <div class="rewardPoints">8888 points</div>
                <button class="redeemBtn" data-id="reward_009" data-name="Free Health Screening Package" data-cost="8888">Redeem</button>
              </div>
            </article>
          </div>
        </div>
      </main>
    </section>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- ===== Footer ===== -->
  <footer>
    <div class="container">
      <div class="footer__inner">
        <div>
          <div class="footer__brandRow">
            <div class="logo" aria-hidden="true" style="width:28px;height:28px;border-radius:10px;">
              <img class="footerlogo" src="ProjectThriveLogo.jpg" alt="Project Thrive Logo"/>
            </div>
            <span class="footer__brandName">Project Thrive</span>
          </div>
          <p class="footer__desc">
            Empowering Singapore‚Äôs youth through innovative health programmes and community engagement.
          </p>
        </div>

        <div class="footerCol">
          <h5>Programme</h5>
          <a href="events.html">Events</a>
          <a href="hybrid-learning.html">Hybrid Learning</a>
          <a href="rewardsPage.html">Rewards</a>
          <a href="ambassadors.html">Ambassadors</a>
        </div>

        <div class="footerCol">
          <h5>Support</h5>
          <a href="#top">Help Center</a>
          <a href="#top">Contact Us</a>
          <a href="#top">FAQ</a>
        </div>

        <div class="footerCol">
          <h5>Connect</h5>
          <div class="footer__social" aria-label="Social links">
            <a class="socialBtn" href="https://www.instagram.com/project_.thrive?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Z" stroke="currentColor" stroke-width="2"/>
                <path d="M12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z" stroke="currentColor" stroke-width="2"/>
                <path d="M17.5 6.5h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
              </svg>
            </a>

            <a class="socialBtn" href="https://www.tiktok.com/@project.thrive0?is_from_webapp=1&sender_device=pc" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M14 3v10.5a4.5 4.5 0 1 1-4-4.47" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M14 3c1.3 2.2 3.2 3.6 6 3.9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </a>

            
            <a class="socialBtn" href="https://t.me/ProjectThrive" target="_blank" rel="noopener noreferrer" aria-label="Telegram">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M21 5L10 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M21 5L15 21L10 12L3 9L21 5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M10 12L15 9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <div class="footerBottom">
        <span>¬© <span id="year"></span> Project Thrive</span>
      </div>
    </div>
  </footer>

  <script src="pt-firebase.js"></script>

  <script>    
    document.getElementById("year").textContent = new Date().getFullYear();

    // ===== toast =====
    const toastEl = document.getElementById("toast");
    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=>toastEl.classList.remove("show"), 1800);
    }

    // ===== scroll =====
    function scrollToId(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({ behavior: "smooth", block: "start" });
      closeMobileNav();
    }

    // ===== Mobile nav =====
    const hamburger = document.getElementById("hamburger");
    const mobileNav = document.getElementById("mobileNav");
    function closeMobileNav(){ mobileNav?.classList.remove("show"); }
    hamburger?.addEventListener("click", () => mobileNav.classList.toggle("show"));

    // ===== Tabs =====
    const subTabsWrapEl = document.getElementById("subTabsWrap");
    const tabs = document.querySelectorAll(".subTab");
    const panels = {
      overview: document.getElementById("tab-overview"),
      redeem: document.getElementById("tab-redeem")
    };
    function setActiveTab(key){
      tabs.forEach(t => t.classList.toggle("active", t.dataset.tab === key));
      Object.values(panels).forEach(p => p.classList.remove("show"));
      panels[key]?.classList.add("show");
      if(key === "redeem") setTimeout(() => scrollToId("catalogue"), 40);
    }
    tabs.forEach(tab => tab.addEventListener("click", () => setActiveTab(tab.dataset.tab)));
    function openRedeemTab(){ setActiveTab("redeem"); }

    // ===== Login gating UI =====
    const loggedInOnlyEl = document.getElementById("loggedInOnly");
    const loggedOutOnlyEl = document.getElementById("loggedOutOnly");

    // ===== Points + Redeem =====
    const pointsValueEl = document.getElementById("pointsValue");
    let currentPoints = 0;
    let redeemedMap = {};

    function applyRedeemedUI(){
      document.querySelectorAll(".redeemBtn").forEach(btn => {
        const rewardId = btn.dataset.id || "";
        if(rewardId && redeemedMap && redeemedMap[rewardId]){
          btn.disabled = true;
          btn.textContent = "Redeemed";
          btn.dataset.redeemed = "1";
        }else{
          btn.dataset.redeemed = "0";
        }
      });
    }

    function renderButtonsForLoggedOut(){
      document.querySelectorAll(".redeemBtn").forEach(b => {
        b.disabled = true;
        b.textContent = "Sign in to redeem";
      });
    }

    function renderPointsAndButtons(){
      if(pointsValueEl) pointsValueEl.textContent = String(currentPoints);

      document.querySelectorAll(".redeemBtn").forEach(btn => {
        if(btn.dataset.redeemed === "1"){
          btn.disabled = true;
          btn.textContent = "Redeemed";
          return;
        }
        const cost = Number(btn.dataset.cost || 0);
        btn.disabled = currentPoints < cost;
        btn.textContent = btn.disabled ? "Not enough points" : "Redeem";
      });
    }

    // ===== Leaderboard (seed + user insert) =====
    const LEADERBOARD_SEED = {
      singapore: [
        { name: "pratwala",      points: 120 },
        { name: "cheeseprata",   points: 95  },
        { name: "thosai3999",    points: 80  },
        { name: "aladinins",     points: 60  },
        { name: "yanrenzhong",   points: 45  }
      ],
      friends: [
        { name: "hupseng",       points: 110 },
        { name: "thonguan",      points: 90  },
        { name: "iueming",       points: 70  },
        { name: "johnsonsuit",   points: 55  },
        { name: "swisschoco",    points: 40  }
      ]
    };

    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, s => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[s]));
    }

    function badgeForRank(rank){
      if(rank === 1) return "üèÜ";
      if(rank === 2) return "ü•à";
      if(rank === 3) return "ü•â";
      return "";
    }

    function renderLeaderboard(listEl, entries){
      if(!listEl) return;
      listEl.innerHTML = entries.slice(0,5).map((u, idx) => {
        const rank = idx + 1;
        const badge = badgeForRank(rank);
        return `
          <li class="leaderRow">
            <span class="rankNo">${rank}</span>
            <span class="badge">${badge}</span>
            <span style="flex:1;">${escapeHtml(u.name)}</span>
            
          </li>
        `;
      }).join("");
    }

    async function getUserNameFromProfile(){
      try{
        const p = await PT.getProfile();  
        if(p && p.name) return String(p.name).trim();
      }catch(_){}
      return "User";
    }


    function mergeUserIntoLeaderboard(seedArr, userObj){
      const filtered = seedArr.filter(e => e.name.toLowerCase() !== userObj.name.toLowerCase());
      const combined = [...filtered, userObj];

      combined.sort((a,b) => (b.points || 0) - (a.points || 0));

      return combined.slice(0,5);
    }

    function combineLeaderboards(dbList, seedList){
      const map = new Map();

      [...(seedList || []), ...(dbList || [])].forEach(item => {
        const name = String(item?.name || "").trim();
        if(!name) return;
        const points = Number(item?.points || 0);
        const safePts = Number.isFinite(points) ? points : 0;

        const key = name.toLowerCase();
        const existing = map.get(key);

        if(!existing || safePts > existing.points){
          map.set(key, { name, points: safePts });
        }
      });

      return Array.from(map.values()).sort((a,b) => (b.points||0) - (a.points||0));
    }

    function getRankFromList(sortedList, userName){
      const key = String(userName || "").trim().toLowerCase();
      if(!key) return null;

      const idx = (sortedList || []).findIndex(x =>
        String(x?.name || "").trim().toLowerCase() === key
      );

      return idx >= 0 ? (idx + 1) : null;
    }



    async function init(){
      PT.applyNavAuthUI({
        signInId: "navSignIn",
        logoutId: "navLogout",
        showWhenLoggedInIds: [],
        logoutRedirect: "login.html"
      });


      if(!PT.isLoggedIn()){
        if(subTabsWrapEl) subTabsWrapEl.style.display = "none";
        if(loggedInOnlyEl) loggedInOnlyEl.style.display = "none";
        if(loggedOutOnlyEl) loggedOutOnlyEl.style.display = "block";

        renderButtonsForLoggedOut();

        try{
          const sgEl = document.getElementById("sgLeaderboard");
          const dbTop = await PT.getSingaporeLeaderboardTop(50); // get more to sort properly
          const combined = combineLeaderboards(dbTop, LEADERBOARD_SEED.singapore);
          renderLeaderboard(sgEl, combined.slice(0,5));
        }catch(e){
          console.warn(e);
          renderLeaderboard(document.getElementById("sgLeaderboard"), LEADERBOARD_SEED.singapore);
        }

        const friendsCardEl = document.getElementById("friendsCard");
        if(friendsCardEl) friendsCardEl.style.display = "none";


        return;
      }

      // Logged in UI
      if(subTabsWrapEl) subTabsWrapEl.style.display = "";
      if(loggedInOnlyEl) loggedInOnlyEl.style.display = "";
      if(loggedOutOnlyEl) loggedOutOnlyEl.style.display = "none";

      try{ await PT.ensureUser(); }catch(e){ console.error(e); }

      try{
        currentPoints = await PT.getPoints();
        redeemedMap = await PT.getRedeemed();
        applyRedeemedUI();
        renderPointsAndButtons();
                // ===== Render leaderboards =====
        const sgEl = document.getElementById("sgLeaderboard");
        const frEl = document.getElementById("friendsLeaderboard");
        const friendsCardEl = document.getElementById("friendsCard");
       
        let dbSG = [];
        try{
          dbSG = await PT.getSingaporeLeaderboardTop(200); 
        }catch(e){
          console.warn("SG DB read failed, using seed only.", e);
          dbSG = [];
        }

        const userName = await getUserNameFromProfile();
        const userEntry = { name: userName, points: Number(currentPoints || 0) };

        const sgFull = combineLeaderboards(
          combineLeaderboards(dbSG, LEADERBOARD_SEED.singapore),
          [userEntry]
        );
        renderLeaderboard(sgEl, sgFull.slice(0,5));
        
        const frFull = combineLeaderboards(LEADERBOARD_SEED.friends, [userEntry]);
        renderLeaderboard(frEl, frFull.slice(0,5));
        if(friendsCardEl) friendsCardEl.style.display = "";
        
        const rankWrap = document.getElementById("rankWrap");
        const rankSGEl = document.getElementById("rankSG");
        const rankFREl = document.getElementById("rankFR");

        const rSG = getRankFromList(sgFull, userName);
        const rFR = getRankFromList(frFull, userName);

        if(rankSGEl) rankSGEl.textContent = rSG ? String(rSG) : "‚Äî";
        if(rankFREl) rankFREl.textContent = rFR ? String(rFR) : "‚Äî";
        if(rankWrap) rankWrap.style.display = "";




      }catch(e){
        console.error(e);
        showToast("Could not load points (DB error).");
      }

      // Redeem click handlers
      document.querySelectorAll(".redeemBtn").forEach(btn => {
        btn.addEventListener("click", async () => {
          if(!PT.isLoggedIn()){
            window.location.href = "login.html";
            return;
          }
          if(btn.dataset.redeemed === "1"){
            showToast("Already redeemed.");
            return;
          }

          const name = btn.dataset.name || "Reward";
          const cost = Number(btn.dataset.cost || 0);
          const rewardId = btn.dataset.id || "reward_unknown";

          if(currentPoints < cost){
            showToast("Not enough points.");
            return;
          }

          try{
            currentPoints = await PT.setPoints(currentPoints - cost);
            await PT.setRedeemed(rewardId, cost);

            redeemedMap[rewardId] = { cost, redeemedAt: Date.now() };
            btn.dataset.redeemed = "1";
            btn.disabled = true;
            btn.textContent = "Redeemed";

            renderPointsAndButtons();
            showToast(`Redeemed: ${name} (-${cost} pts)`);
          }catch(e){
            console.error(e);
            showToast("Redeem failed (DB error).");
           
            try{
              currentPoints = await PT.getPoints();
              redeemedMap = await PT.getRedeemed();
              applyRedeemedUI();
              renderPointsAndButtons();
            }catch(_){}
          }
        });
      });
    }

    init();
  </script>
</body>
</html>
